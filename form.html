<!DOCTYPE html>
<html lang="ja">
<head>
    <meta name="robots" content="noindex, nofollow">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATTENDANCE | Hirotaka & Sae</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Old+Mincho:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f8f7f5;
            --text-main: #4a4a4a;
            --text-sub: #999;
            --accent-gold: #c5a059;
            --line-color: #d1d1d1;
        }
        body { margin: 0; padding: 0; background: var(--bg-color); color: var(--text-main); font-family: 'Zen Old Mincho', serif; -webkit-font-smoothing: antialiased; }
        .container { max-width: 650px; margin: 0 auto; padding: 80px 25px; }
        h1 { text-align: center; font-size: 1.8rem; letter-spacing: 0.4em; font-weight: 400; margin-bottom: 80px; text-transform: uppercase; }
        .form-group { margin-bottom: 50px; }
        label { display: block; font-size: 0.9rem; margin-bottom: 15px; letter-spacing: 0.1em; }
        label span.required { font-size: 0.65rem; color: var(--text-sub); margin-left: 10px; font-family: sans-serif; }
        input[type="text"], input[type="email"], textarea { width: 100%; border: none; border-bottom: 1px solid var(--line-color); background: transparent; padding: 12px 0; font-family: inherit; font-size: 1rem; color: var(--text-main); outline: none; transition: border-color 0.3s; }
        input:focus, textarea:focus { border-bottom: 1px solid var(--accent-gold); }
        .radio-group { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 10px; }
        .radio-item { display: flex; align-items: center; cursor: pointer; font-size: 0.9rem; }
        .radio-item input { margin-right: 8px; accent-color: var(--accent-gold); }
        .hidden-field { display: none; margin-top: 20px; border-left: 1px solid var(--line-color); padding-left: 20px; }
        .show-field { display: block; }
        .submit-container { text-align: center; margin-top: 80px; }
        .submit-btn { background: transparent; border: 1px solid var(--line-color); padding: 25px 80px; font-family: inherit; font-size: 0.8rem; letter-spacing: 0.3em; cursor: pointer; transition: 0.4s; text-transform: uppercase; color: var(--text-main); }
        .submit-btn:hover { border-color: var(--accent-gold); color: var(--accent-gold); background: #fff; }
        .submit-btn:disabled { color: var(--text-sub); border-color: var(--line-color); cursor: not-allowed; }
        @media (max-width: 768px) { .radio-item { width: 45%; } }
    </style>
</head>
<body>

<div class="container">
    <h1>Attendance</h1>

    <form action="https://script.google.com/macros/s/AKfycbzT4StwUU7TMkUVMVM0qDL9NcHpapdbc7N4stT4MJ2KYwkJK8ewNFFuZ8Xa5Jr5cWhRjw/exec" method="POST">
        
        <div class="form-group">
            <label>氏名<span class="required">required</span></label>
            <input type="text" name="name" placeholder="山田 太郎" required>
        </div>

        <div class="form-group">
            <label>氏名(ローマ字)<span class="required">required</span></label>
            <input type="text" name="name_kana" placeholder="TARO YAMADA" required>
        </div>

        <div class="form-group">
            <label>メールアドレス</label>
            <input type="email" name="email" placeholder="example@mail.com">
        </div>

        <div class="form-group">
            <label>出欠<span class="required">required</span></label>
            <div class="radio-group">
                <label class="radio-item"><input type="radio" name="attendance" value="ご出席" required> ご出席</label>
                <label class="radio-item"><input type="radio" name="attendance" value="ご欠席"> ご欠席</label>
            </div>
        </div>

        <div class="form-group">
            <label>二次会の出欠<span class="required">required</span></label>
            <div class="radio-group">
                <label class="radio-item"><input type="radio" name="party_attendance" value="ご出席" required> ご出席</label>
                <label class="radio-item"><input type="radio" name="party_attendance" value="ご欠席"> ご欠席</label>
                <label class="radio-item"><input type="radio" name="party_attendance" value="未定"> 未定</label>
            </div>
        </div>

        <div class="form-group">
            <label>ご関係<span class="required">required</span></label>
            <div class="radio-group">
                <label class="radio-item"><input type="radio" name="relation" value="新郎友人" required> 新郎友人</label>
                <label class="radio-item"><input type="radio" name="relation" value="新郎同僚"> 新郎同僚</label>
                <label class="radio-item"><input type="radio" name="relation" value="新郎親族"> 新郎親族</label>
                <label class="radio-item"><input type="radio" name="relation" value="新婦友人"> 新婦友人</label>
                <label class="radio-item"><input type="radio" name="relation" value="新婦同僚"> 新婦同僚</label>
                <label class="radio-item"><input type="radio" name="relation" value="新婦親族"> 新婦親族</label>
            </div>
        </div>

        <div class="form-group">
            <label>同伴者数<span class="required">required</span></label>
            <div class="radio-group">
                <label class="radio-item"><input type="radio" name="guest_count" value="なし" onclick="toggleGuests(0)" required> なし</label>
                <label class="radio-item"><input type="radio" name="guest_count" value="1名" onclick="toggleGuests(1)"> 1名</label>
                <label class="radio-item"><input type="radio" name="guest_count" value="2名" onclick="toggleGuests(2)"> 2名</label>
                <label class="radio-item"><input type="radio" name="guest_count" value="3名" onclick="toggleGuests(3)"> 3名</label>
                <label class="radio-item"><input type="radio" name="guest_count" value="4名" onclick="toggleGuests(4)"> 4名</label>
                <label class="radio-item"><input type="radio" name="guest_count" value="5名" onclick="toggleGuests(5)"> 5名</label>
            </div>
        </div>

        <div id="guest-fields">
            <div id="gf1" class="form-group hidden-field"><label>同伴者1 氏名</label><input type="text" name="guest_name_1"></div>
            <div id="gf2" class="form-group hidden-field"><label>同伴者2 氏名</label><input type="text" name="guest_name_2"></div>
            <div id="gf3" class="form-group hidden-field"><label>同伴者3 氏名</label><input type="text" name="guest_name_3"></div>
            <div id="gf4" class="form-group hidden-field"><label>同伴者4 氏名</label><input type="text" name="guest_name_4"></div>
            <div id="gf5" class="form-group hidden-field"><label>同伴者5 氏名</label><input type="text" name="guest_name_5"></div>
        </div>

        <div class="form-group">
            <label>アレルギーの有無<span class="required">required</span></label>
            <div class="radio-group">
                <label class="radio-item"><input type="radio" name="allergy_check" value="なし" onclick="toggleAllergy(false)" required> なし</label>
                <label class="radio-item"><input type="radio" name="allergy_check" value="あり" onclick="toggleAllergy(true)"> あり</label>
            </div>
        </div>

        <div id="allergy-field" class="form-group hidden-field">
            <label>アレルギー内容</label>
            <textarea name="allergy_detail" rows="3" placeholder="お名前と詳細をご記入ください"></textarea>
        </div>

        <div class="form-group">
            <label>その他(備考)</label>
            <textarea name="memo" rows="4" placeholder="メッセージ等ございましたらご記入ください"></textarea>
        </div>

        <div class="submit-container">
            <button type="submit" class="submit-btn">Send Message</button>
        </div>
    </form>
</div>

<script>
    function toggleGuests(count) {
        for (let i = 1; i <= 5; i++) {
            const f = document.getElementById(`gf${i}`);
            i <= count ? f.classList.add('show-field') : f.classList.remove('show-field');
        }
    }
    function toggleAllergy(show) {
        const f = document.getElementById('allergy-field');
        show ? f.classList.add('show-field') : f.classList.remove('show-field');
    }
    // 送信ボタンの制御コード（ここが 141 行目付近の修正箇所です）
    document.querySelector('form').addEventListener('submit', function() {
        const btn = document.querySelector('.submit-btn');
        btn.disabled = true;
        btn.innerText = "SENDING...";
    });
</script>
</body>
</html>
